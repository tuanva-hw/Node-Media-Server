<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<video controls id="video" width="800">
</video>

<select id="cars" onchange="change(this)">
  <option value="1080" selected>1080</option>
  <option value="720">720</option>
  <option value="480">480</option>
  <option value="360">360</option>
</select>

<script>
  load = (quality) => {
    console.log(quality);
    var video = document.getElementById('video');
    // var videoSrc = "https://kp6nj67ml2c2i3.data.mediastore.ap-northeast-1.amazonaws.com/livea/main.m3u8";
    var videoSrc = `http://localhost:8000/hls_${quality}p/1/index.m3u8`;
    if (Hls.isSupported()) {
      var hls = new Hls();
      hls.loadSource(videoSrc);
      hls.attachMedia(video);
      hls.on(Hls.Events.MANIFEST_PARSED, function() {
        video.play();
      });
    }
    else if (video.canPlayType('application/vnd.apple.mpegurl')) {
      video.src = videoSrc;
      video.addEventListener('loadedmetadata', function() {
        video.play();
      });
    }
  };
  load(1080);

  change = (obj) => {
    let value =  obj.options[obj.selectedIndex].getAttribute('value');
    load(value);
  }
</script>
